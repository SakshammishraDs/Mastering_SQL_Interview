# SQLInterview Q&A

This repository contains a collection of commonly asked *SQL Interview Questions** with detailed answers. It’s a great resource for preparing for SQL-related interviews or for anyone wanting to improve their SQL knowledge.

---

## 1. SQL Query to Find Employees with No Sales in the Last 3 Months

**Interviewer**: Write a SQL query to find employees who have not had any recent sales in the last 3 months.

**You**:

To find employees who have not made any sales in the last 3 months, I would write a query that joins the `Employees` and `Sales` tables (assuming these are the table names). The query would filter employees who have no sales records in the last 3 months.

Here’s the SQL query:

```sql
SELECT e.EmployeeID, e.EmployeeName
FROM Employees e
LEFT JOIN Sales s ON e.EmployeeID = s.EmployeeID
AND s.SaleDate >= DATEADD(MONTH, -3, GETDATE())  -- Filter sales within the last 3 months
GROUP BY e.EmployeeID, e.EmployeeName
HAVING COUNT(s.SaleID) = 0;  -- No sales in the last 3 months
```

---
## 2. SQL Query to Calculate Total Revenue by Region

**Interviewer**: Write a query to calculate the total revenue generated by each region.

**You**:

To calculate the total revenue generated by each region, I'll assume there are two tables: `Sales` (which contains revenue details) and `Regions` (which maps each sale to a region). Here’s the SQL query:

```sql
SELECT r.RegionName, SUM(s.Revenue) AS TotalRevenue
FROM Sales s
JOIN Regions r ON s.RegionID = r.RegionID
GROUP BY r.RegionName;
```

---
## 3. SQL Query to Display Employees with Salary Above the Average in Their Department

**Interviewer**: Display the names of employees who have a salary above the average salary in their department.

**You**:

To display the names of employees who have a salary above the average salary in their respective departments, I'll assume there are two tables: `Employees` (with employee details including salary) and `Departments` (with department details). Here's the SQL query:

```sql
SELECT e.EmployeeName
FROM Employees e
JOIN Departments d ON e.DepartmentID = d.DepartmentID
WHERE e.Salary > (
    SELECT AVG(e2.Salary)
    FROM Employees e2
    WHERE e2.DepartmentID = e.DepartmentID
)
```

---



## 4. SQL Query to Identify the Second Highest Salary in Each Department

**Interviewer**: Identify the second highest salary in each department from the 'employees' table, which has 'emp_id', 'department_id', and 'salary' columns.

**You**:

To find the second highest salary in each department, we can use a subquery to rank salaries within each department and then filter for the second highest. Here’s the SQL query:

```sql
SELECT department_id, MAX(salary) AS second_highest_salary
FROM employees
WHERE salary < (
    SELECT MAX(salary)
    FROM employees e2
    WHERE e2.department_id = employees.department_id
)
GROUP BY department_id;
```

---

## 5. SQL Query to Display Employee's Name Along with Manager's Name Using Self-Join

**Interviewer**: Write a SQL query to display the employee’s name along with their manager’s name using a self-join on the ‘employees’ table, which contains ‘emp_id’, ‘name’, and ‘manager_id’ columns.

**You**:

To display the employee's name along with their manager's name, I would perform a **self-join** on the `employees` table, where one instance of the table represents the employee and the other represents the manager. Here’s the SQL query:

```sql
SELECT e.name AS employee_name, m.name AS manager_name
FROM employees e
LEFT JOIN employees m ON e.manager_id = m.emp_id;
```


---

## 6. SQL Query to Find the Most Recent Hire for Each Department Using LEAD/LAG Functions

**Interviewer**: Find the most recent hire for each department (solved using LEAD/LAG functions).

**You**:

To find the most recent hire for each department using `LEAD()` or `LAG()` functions, we can use these window functions to compare each employee's hire date with the previous or next employee's hire date within the same department.

Here’s how you can do it:

```sql
WITH RankedEmployees AS (
    SELECT emp_id, department_id, name, hire_date,
           LEAD(hire_date) OVER (PARTITION BY department_id ORDER BY hire_date DESC) AS next_hire_date
    FROM employees
)
SELECT emp_id, department_id, name, hire_date
FROM RankedEmployees
WHERE next_hire_date IS NULL;
```

---



## 7. SQL Query to Retrieve the nth Highest Salary from the Employees Table

**Interviewer**: Write a query to retrieve the nth highest salary from the Employees table, which has ‘EmployeeID’, ‘Name’, and ‘Salary’ columns.

**You**:

To retrieve the nth highest salary, I would use a combination of the `DISTINCT` and `ORDER BY` clauses along with `LIMIT` or a window function (depending on the database). Here’s how to do it using a **subquery**:

### Query:

```sql
SELECT MAX(Salary) AS nth_highest_salary
FROM Employees
WHERE Salary IN (
    SELECT DISTINCT Salary
    FROM Employees
    ORDER BY Salary DESC
    LIMIT n
)
```

### Explanation:
- **DISTINCT Salary**: This ensures that we are considering only unique salary values.
- **ORDER BY Salary DESC**: This orders the salaries in descending order to get the highest salary first.
- **LIMIT n**: Limits the result to the top `n` distinct salaries (replace `n` with the specific rank you want).
- **MAX(Salary)**: Since we limit the result to the nth salary, we use `MAX()` to get the nth highest salary.

This query will return the nth highest salary in the `Employees` table. Just replace `n` with the desired rank number (e.g., 1 for the highest, 2 for the second highest, etc.).

### Alternate (for databases supporting window functions like PostgreSQL or SQL Server):

```sql
WITH SalaryRank AS (
    SELECT Salary, DENSE_RANK() OVER (ORDER BY Salary DESC) AS rank
    FROM Employees
)
SELECT Salary
FROM SalaryRank
WHERE rank = n;
```

This query uses `DENSE_RANK()` to assign a rank to each salary, and then filters for the nth highest salary.


This approach demonstrates two methods for retrieving the nth highest salary—one using a subquery and another leveraging window functions like `DENSE_RANK()`.

---




























